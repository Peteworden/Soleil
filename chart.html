<!DOCTYPE html>
<html lang="ja">
<head>
    <title>ぴーとの星図</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="description" content="指やマウスで直感的に操作できる、12.0等級までのモバイル星図です。惑星、11.5等級までの恒星、メシエ天体、NGC天体など天体を豊富に収録しており、検索機能もあります。ネット環境があればURLにアクセスするだけで使用可能。">
    <meta name="theme-color" content="#000000">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="stylesheet" href="styles/styleChart.css?v=251007-1223">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VG4YXL3M6E"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="apple-touch-icon" sizes="180x180" href="images/icon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="images/icon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/icon/favicon-16x16.png">
    <!-- <link rel="manifest" href="./manifest.json"> -->
    <link rel="manifest" href="images/icon/site.webmanifest">
    <!-- Google tag (gtag.js) -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/Soleil/service-worker.js').then(() => {
                    console.log('Service Worker registered!');
                });
            });
        }

        if (navigator.onLine) {
            var link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = 'https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css';
            document.head.appendChild(link);
            link.href = "https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css";
            document.head.appendChild(link);
        }

        // Google tag (gtag.js) 
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-VG4YXL3M6E');
    </script>
</head>
<body>
    <!-- 新機能お知らせポップアップ -->
    <div id="newsPopup" class="news-popup" style="display: none;">
        <div class="news-popup-content">
            <div class="news-popup-header">
                <h3>news</h3>
                <button id="closeNewsPopup" class="news-popup-close" type="button">&times;</button>
            </div>
            <div class="news-popup-body">
                <div id="newsItem" class="news-item"></div>
            </div>
            <div class="news-popup-footer">
                <button id="dontShowAgainBtn" class="dont-show-again-btn" type="button">今後newsを表示しない</button>
                <button id="closeNewsBtn" class="close-news-btn" type="button">閉じる</button>
            </div>
        </div>
    </div>

    <!-- キャッシュ情報ポップアップ -->
    <div id="cacheInfoPopup" class="cache-info-popup" style="display: none;">
        <div class="cache-info-popup-content">
            <div class="cache-info-popup-header">
                <h3>キャッシュ情報</h3>
                <button id="closeCacheInfoPopup" class="cache-info-popup-close" type="button">&times;</button>
            </div>
            <div class="cache-info-popup-body">
                <div id="cacheInfoText" class="cache-info-text"></div>
            </div>
            <div class="cache-info-popup-footer">
                <button id="forceCacheUpdateBtn" class="force-cache-update-btn" type="button">キャッシュ強制更新</button>
                <button id="reloadCacheBtn" class="reload-cache-btn" type="button">ページ再読み込み</button>
                <button id="closeCacheInfoBtn" class="close-cache-info-btn" type="button">閉じる</button>
            </div>
        </div>
    </div>

    <!-- <img id="welcomeImage" class="welcomeImage" src="images/welcome0928.jpg"> -->
    
    <!-- タイトルバー -->
    <div class="title" id="title">
        <ul>
            <li><h3 id="titleText">星図</h3></li>
            <li><a href="PeteHOME.html">HOME</a></li>
            <li><a href="chart_js.html">旧バージョン</a></li>
            <div id="loadingtext">Loading...</div>
        </ul>
    </div>

<!--
        <p><span style="color: orange;">星図を開いてからバージョンを変えたい場合は、リロードするか、画面左上にリンクがある「HOME」を経由してください。</span></p>
        <p>旧バージョンにしかない機能（ほとんどは今後新バージョンにも実装予定）</p>
        <ul>
            <li>風景と重ねる機能</li>
            <li>惑星の移動を描画</li>
            <li>ガリレオ衛星</li>
            <li>ダークモード</li>
            <li>地形を描画</li>
            <li>2000.0年分点による座標の表示</li>
            <li>(URLによる状態の保存)</li>
        </ul>
    </div>
-->

    <!-- 情報表示エリア -->
    <div class="info-display" id="infoDisplay">
        <div class="info-row">
            <!-- <span class="info-label">観測地:</span> -->
            <span class="info-value" id="locationInfo">--</span>
        </div>
        <div class="info-row">
            <!-- <span class="info-label">時刻:</span> -->
            <span class="info-value" id="timeInfo">--</span>
        </div>
        <div class="info-row">
            <span id="centerLabel" class="info-label">中心:</span>
            <span id="centerConstellation" class="info-value">--</span>
        </div>
        <div class="info-row">
            <span class="info-value" id="centerInfo">--</span>
        </div>
        <div class="info-row">
            <span class="info-label">視野（左右）:</span>
            <span class="info-value" id="fovInfo">--</span>
        </div>
        <div class="info-row">
            <span class="info-label">最微等級:</span>
            <span class="info-value" id="limitingMagnitudeInfo">--</span>
        </div>
    </div>

    <!-- PC用ボタン配置 -->
    <div class="top-right-buttons">
        <button id="searchBtn" class="main-screen-button search-button" type="button">
            <img src="images/search.png" alt="検索">
        </button>
        <button id="settingBtn" class="main-screen-button setting-button" type="button">
            <img src="images/settingBtn.png" alt="設定">
        </button>
        <button id="descriptionBtn" class="main-screen-button" type="button">
            <img src="images/menu.png" alt="説明">
        </button>
    </div>

    <!-- スマホ用ボタンドック -->
    <div class="mobile-button-dock" id="mobileButtonDock">
        <button id="searchBtnMobile" class="main-screen-button search-button" type="button">
            <img src="images/search.png" alt="検索">
        </button>
        <button id="settingBtnMobile" class="main-screen-button setting-button" type="button">
            <img src="images/settingBtn.png" alt="設定">
        </button>
        <button id="descriptionBtnMobile" class="main-screen-button" type="button">
            <img src="images/menu.png" alt="説明">
        </button>
        <button id="fullScreenBtnMobile" class="main-screen-button" type="button">
            <img src="images/fullScreenBtn.png" alt="全画面表示">
        </button>
    </div>

    <!-- 設定画面 -->
    <div id="setting" class="setting" style="display: none;">
        <div class="settingBlock">
            <!-- タブナビゲーション -->
            <div class="setting-tabs">
                <button class="setting-tab active" data-tab="basic">基本設定</button>
                <button class="setting-tab" data-tab="display">表示設定</button>
                <button class="setting-tab" data-tab="objects">その他の設定</button>
            </div>

            <div class="setting-content">
                <!-- 基本設定タブ -->
                <div id="basic-tab" class="setting-section">
                    <h3>場所/日時</h3>

                    <div class="setting-row">
                        <label>時刻:</label>
                        <input type="datetime-local" id="dtl" name="dtl" value=""/>
                        <button id="dtlNow" type="button">現在時刻</button>
                    </div>

                    <div class="switch-row">
                        <label class="switch-text">読み込み時に現在時刻にする:</label>
                        <label class="switch">
                            <input type="checkbox" id="loadOnCurrentTime" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>

                    <div class="setting-row">
                        <label>リアルタイム:</label>
                        <select id="realTime">
                            <option value="off" checked>オフ</option>
                            <option value="radec">赤経・赤緯固定</option>
                            <option value="azalt">方位・高度固定</option>
                        </select>
                    </div>
                    
                    <div class="setting-row">
                        <label>視点:</label>
                        <select id="observer_planet">
                            <option>太陽</option>
                            <option>水星</option>
                            <option>金星</option>
                            <option selected>地球</option>
                            <option>火星</option>
                            <option>木星</option>
                            <option>土星</option>
                            <option>天王星</option>
                            <option>海王星</option>
                            <option>月</option>
                            <option>Ceres</option>
                            <option>Vesta</option>
                        </select>
                        <button id="observerPlanetHelpBtn" class="help-button" type="button" title="視点の説明">
                            <i class="fas fa-question-circle"></i>
                        </button>
                    </div>

                    <div id="observerPlanetHelpPopup" class="help-popup" style="display: none;">
                        <div class="help-popup-content">
                            <div class="help-popup-header">
                                <h4>視点</h4>
                                <button id="closeObserverPlanetHelp" class="help-popup-close" type="button">&times;</button>
                            </div>
                            <div class="help-popup-body">
                                <p>観測者がいる天体を選びます。地球以外の視点は、「表示設定」->「表示モード」を「赤道座標系」にしているときに選択できます。</p>
                            </div>
                        </div>
                    </div>

                    <div class="setting-row">
                        <label>観測地:</label>
                        <select id="observation-site-select">
                            <option selected>カスタム</option>
                            <option>現在地</option>
                            <option>京大西部構内</option>
                            <option>鵜倉園地</option>
                            <option>乗鞍高原</option>
                            <option>仙台</option>
                            <option>東京</option>
                            <option>大阪</option>
                            <option>石垣島</option>
                            <option>地図上で選択</option>
                        </select>
                    </div>

                    <div class="setting-row">
                        <label>緯度:</label>
                        <select id="NSCombo" class="observation-site-select">
                            <option selected>北緯</option>
                            <option>南緯</option>
                        </select>
                        <input type="text" id="lat" class="observation-site-input" size="1" value="35">°
                    </div>

                    <div class="setting-row">
                        <label>経度:</label>
                        <select id="EWCombo" class="observation-site-select">
                            <option selected>東経</option>
                            <option>西経</option>
                        </select>
                        <input type="text" id="lon" class="observation-site-input" size="1" value="135">°
                    </div>

                    <p class="donation-text">
                        現在は星図に関する費用はゼロですが、将来的にはオフラインで使えるようにスマホアプリ化なども検討しており、それには費用がかかります。
                        でも広告は入れたくないので、もしよければPayPayなどで個人的に寄付いただけるととても嬉しいです。
                        ほしい機能や特典の提案、星図の不具合があれば、<a href="https://forms.gle/m4v7RbdWMANbt5s28" target="_blank">ご意見フォーム</a>からお願いします。
                    </p>
                </div>

                <!-- 表示設定タブ -->
                <div id="display-tab" class="setting-section" style="display: none;">
                    <h3>表示設定</h3>

                    <div class="setting-row">
                        <label>表示モード:</label>
                        <select id="mode">
                            <option value="AEP">赤道座標系</option>
                            <option value="view" checked>プラネタリウム</option>
                            <option value="live">スマホに合わせる</option>
                            <option value="ar">風景と重ねる（β版）</option>
                        </select>
                        <button id="modeHelpBtn" class="help-button" type="button" title="表示モードの説明">
                            <i class="fas fa-question-circle"></i>
                        </button>
                    </div>

                    <div id="modeHelpPopup" class="help-popup" style="display: none;">
                        <div class="help-popup-content">
                            <div class="help-popup-header">
                                <h4>表示モードの説明</h4>
                                <button id="closeModeHelp" class="help-popup-close" type="button">&times;</button>
                            </div>
                            <div class="help-popup-body">
                                <ul>
                                    <li><strong>赤道座標系:</strong> 一般的な星図や天体写真と同じく、天の北極が上になった表示。赤道儀での導入にも便利。</li>
                                    <li><strong>プラネタリウム:</strong> 観測地や時刻に合わせ、実際の空と同じ向きで表示します。地球上の視点にのみ対応しています。</li>
                                    <li><strong>スマホに合わせる:</strong> スマートフォンの向きや傾きに応じて表示します。iPhoneやiPadではデバイスの向きの使用許可が必要です。デバイスを8の字に動かすと精度が上がります。画面の回転はオフにしてください。パソコンでは使用できません。</li>
                                    <li><strong>風景と重ねる:</strong> カメラの映像と星図を重ねて表示します。注意点は「スマホに合わせる」と同じです。</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- デバイスオリエンテーション許可ボタン（iPhone用） -->
                    <div class="setting-row" id="orientationPermissionRow" style="display: none;">
                        <label>デバイスの向き:</label>
                        <button id="orientationPermissionBtn" type="button" style="background-color: #4CAF50; color: white; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer;">
                            デバイスの向きの使用を許可
                        </button>
                    </div>

                    <div id="arOpacitySliderDiv" class="setting-row">
                        <label>風景の透明度:</label>
                        <div class="set-ar-opacity-limit">
                            <label>0</label>
                            <input type="range" id="arOpacitySlider" min="0" max="1" step="0.1" value="0.3">
                            <label>1</label>
                        </div>
                    </div>

                    <div id="arFovDiv" class="setting-row" style="display: block;">
                        <label>長辺の視野角:</label>
                        <input type="text" id="arFov" class="ar-fov-input" size="1" value="50">°
                    </div>

                    <div class="setting-row">
                        <label>最微等級:</label>
                        <div class="set-mag-limit">
                            <img src="images/キラキラ1.png" alt="" class="magLimit-image magLimit-left-image">
                            <input type="range" id="magLimitSlider" min="8" max="13" step="0.1" value="11">
                            <img src="images/キラキラ2.png" alt="" class="magLimit-image magLimit-right-image">
                        </div>
                    </div>
                    <div class="switch-row">
                        <label class="switch-text">表示する星:</label>
                        <select id="usedStarSelect">
                            <option value="noStar">表示しない</option>
                            <option value="to6">6等星まで</option>
                            <option value="to10">10.0等星まで</option>
                            <option value="to12" selected>12.0等星まで</option>
                        </select>
                    </div>

                    <div class="switch-row">
                        <label class="switch-text">ダークモード:</label>
                        <label class="switch">
                            <input type="checkbox" id="dark">
                            <span class="slider round"></span>
                        </label>
                    </div>

                    <div class="switch-row">
                        <label class="switch-text">グリッド表示:</label>
                        <label class="switch">
                            <input type="checkbox" id="gridCheck" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>

                    <div class="switch-row">
                        <label class="switch-text">中心表示:</label>
                        <label class="switch">
                            <input type="checkbox" id="reticleCheck" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>

                    <div class="switch-row">
                        <label class="switch-text">クリックで天体情報:</label>
                        <label class="switch">
                            <input type="checkbox" id="objectInfoCheck" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>

                    
                    <h5>星雲・星団など</h5>
                    <div class="switch-row">
                        <label class="switch-text">メシエ天体:</label>
                        <label class="switch">
                            <input type="checkbox" id="messierCheck" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="switch-row">
                        <label class="switch-text">おすすめ天体:</label>
                        <label class="switch">
                            <input type="checkbox" id="recCheck" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="switch-row">
                        <label class="switch-text">NGC・IC天体:</label>
                        <label class="switch">
                            <input type="checkbox" id="ngcCheck" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <h5>画角</h5>
                    <select id="camera">
                        <option value="none">なし</option>
                        <option value="r200ss-cmos">R200SS-CMOS</option>
                        <option value="fs128-cmos">FS128-CMOS</option>
                        <option value="85-cmos">85-CMOS</option>
                    </select>

                    <h5>恒星</h5>
                    <div class="switch-row">
                        <label class="switch-text">恒星名表示:</label>
                        <select id="starName">
                            <option value="off">なし</option>
                            <option value="to1" checked>1等星まで</option>
                            <option value="to2">2等星まで</option>
                            <option value="all">すべて</option>
                        </select>
                    </div>
                    <div class="switch-row">
                        <label class="switch-text">バイエル符号・フラムスティード番号表示:</label>
                        <label class="switch">
                            <input type="checkbox" id="bayerFSCheck" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>

                    <h5>星座</h5>
                    <div class="switch-row">
                        <label class="switch-text">星座名:</label>
                        <label class="switch">
                            <input type="checkbox" id="constellationNameCheck" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <div class="switch-row">
                        <label class="switch-text">星座線:</label>
                        <label class="switch">
                            <input type="checkbox" id="constellationLineCheck" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <h5>太陽系天体</h5>
                    <div class="switch-row">
                        <label class="switch-text">惑星・小惑星・彗星:</label>
                        <label class="switch">
                            <input type="checkbox" id="planetCheck" checked>
                            <span class="slider round"></span>
                        </label>
                    </div>

                    <h5>画面左上の情報</h5>
                    <div class="switch-row">
                        <label class="switch-text">赤道座標の基準:</label>
                        <select id="equinox">
                            <option value="apparent" checked>視位置(正確には平均春分点)</option>
                            <option value="j2000">J2000.0</option>
                        </select>
                    </div>
                </div>

                <!-- 色などの設定タブ -->
                <div id="objects-tab" class="setting-section" style="display: none;">
                    <h3>その他の設定</h3>
                    <div class="setting-row">
                        <button id="openUserObjectManage" type="button">天体を追加・編集</button>
                    </div>

                    <div class="setting-row">
                        <button id="clearLocalStorage" type="button">設定を初期化</button>
                        <button id="checkDefaultConfig" type="button">初期設定を確認</button>
                        <div id="defaultConfigPopup" class="help-popup" style="display: none;">
                            <div class="help-popup-content">
                                <div class="help-popup-header">
                                    <h4>初期設定</h4>
                                    <button id="closeDefaultConfigPopup" class="help-popup-close" type="button">&times;</button>
                                </div>
                                <div class="help-popup-body">
                                    <div id="defaultConfig"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="setting-row">
                        <button id="showCacheInfoBtn" class="cache-info-button" type="button">キャッシュ情報</button>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button id="showBtn" class="showBtn" type="button">OK</button>
            </div>
        </div>
    </div>

    <div id="observation-site-map-div" class="observation-site-map-div" style="display: none;">
        <div id="observation-site-map" class="observation-site-map"></div>
        <div class="map-buttons">
            <button id="closeObservationSiteMap" class="closeObservationSiteMap" type="button">OK</button>
        </div>
    </div>

    <!-- PC用全画面ボタン -->
    <div class="bottom-right-buttons">
        <button id="fullScreenBtn" class="main-screen-button" type="button">
            <img src="images/fullScreenBtn.png" alt="全画面表示">
        </button>
    </div>

    <!-- 検索画面 -->
    <div id="search" class="search" style="display: none;">
        <input type="text" id="searchInput" class="search-input" placeholder="ここに入力して検索">
        <div id="numberOfResults" class="numberOfResults"></div>
        <div id="suggestionButtonContainer" class="suggestionButtonContainer"></div>
        <!-- <button id="closeSearch" type="button">閉</button> -->
    </div>

    <!-- 説明画面 -->
    <div id="description" class="description" style="display: none;">
        <div class="description-header">
            <h3>memo</h3>
            <button id="closeDescription" type="button">閉じる</button>
        </div>
        
        <div class="description-content">
            <!-- 関連リンク -->
            <div class="description-section">
                <h4>🔗 関連リンク</h4>
                <ul>
                    <li><strong>ご意見フォーム:</strong> <a href="https://forms.gle/m4v7RbdWMANbt5s28" target="_blank">ご意見フォーム</a></li>
                    <li><strong>画像提供:</strong> <a href="https://forms.gle/m4v7RbdWMANbt5s28" target="_blank">バグ報告フォーム</a></li>
                    <li><strong>木星の衛星:</strong> <a href="https://www.ncsm.city.nagoya.jp/astro/jupiter/" target="_blank">名古屋市科学館</a></li>
                    <li><strong>土星の衛星:</strong> <a href="https://skyandtelescope.org/wp-content/plugins/observing-tools/saturn_moons/saturn.html" target="_blank">SKY & TELESCOPE</a></li>
                    <li><strong>Heavens-Above:</strong> <a href="https://www.heavens-above.com/" target="_blank">Heavens-Above</a></li>
                    <li><strong>ぴーとの部屋（トップ）:</strong> <a href="https://peteworden.github.io/Soleil/PeteHOME.html" target="_blank">トップ</a></li>
                    <li><strong>もっと細かい星図を作成:</strong> <a href="https://peteworden.github.io/Soleil/gaiaChart.html" target="_blank">Gaia Archiveのデータから星図を作る</a></li>
                    <li><strong>簡易水準器:</strong> <a href="https://peteworden.github.io/Soleil/level.html" target="_blank">簡易水準器</a></li>
                    <li><strong>ソースコード・データソース:</strong> <a href="https://github.com/Peteworden/Soleil" target="_blank">GitHub</a></li>
                </ul>
            </div>

            <!-- 記号の説明 -->
            <div class="description-section">
                <h4>⭐ 記号</h4>
                <ul>
                    <li>楕円: 銀河</li>
                    <li>◇: 星雲</li>
                    <li>△: 散開星団</li>
                    <li>○: 球状星団</li>
                    <li>☆: 1~数個の星</li>
                </ul>
            </div>

            <!-- 共有用QRコードへのボタン -->
            <div class="description-section">
                <h4>🔗 QRコードで広めてね！</h4>
                <details>
                    <summary>QRコードを表示</summary>
                    <div id="shareQrCode">
                        <img src="chartImage/chartqr.png" alt="QRコード">
                        <p>QRコードは株式会社デンソーウェーブの登録商標です</p>
                    </div>
                </details>
            </div>

            <div class="description-section">
                <h4>Known Issues</h4>
                <ul>
                    <li>読み込み時に時刻のスライダーの丸が左端にあるときがある</li>
                    <li>風景と重ねるモードにある多数のバグ</li>
                    <li>スマホだとちょっと縦長になっている</li>
                    <li>全画面表示がうまく動かないときがある</li>
                    <li>ほかにあればご意見フォームで教えてください</li>
                </ul>
            </div>

            <div class="description-section">
                <h4>Todo</h4>
                <ul>
                    <li>画面中心が属する星座を表示</li>
                    <li>バイエル符号、フラムスティード番号を表示</li>
                    <li>出没時刻を表示</li>
                    <li>ダークモード</li>
                    <li>大気差</li>
                    <li>お気に入り観測地</li>
                    <li>星雲の絵を増やす</li>
                    <li>おすすめ天体の提案</li>
                    <li>ほかにあればご意見フォームで教えてください</li>
                </ul>
            </div>

            <div class="description-section">
                <h4>🔭 自分用 観望会・出撃の持ち物リスト</h4>
                <ul>
                    <li><strong>望遠鏡:</strong> 経緯台とアイピースの袋も忘れずに</li>
                    <li><strong>カメラ:</strong> バッテリー入れた？</li>
                    <li><strong>三脚</strong></li>
                    <li><strong>コンタクトの用意とメガネ:</strong>ケース、洗浄液</li>
                    <li><strong>パソコン:</strong> 撮影で使うかも</li>
                    <li><strong>防寒着:</strong> 夏以外はしっかりと</li>
                    <li><strong>財布:</strong> 免許証も</li>
                    <li><strong>その他:</strong> 暗い天体を見るときは詳しい星図を作っておく</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 天体情報画面 -->
    <div id="objectInfo" class="objectInfo" style="display: none;">
        <button id="closeObjectInfo" type="button">&times;</button>
        <div id="objectInfoName"></div>
        <div id="objectInfoImage"></div>
        <div id="objectInfoText"></div>
    </div>

    <!-- スライダー -->
    <div id="controlPanel" class="control-panel">
        <div id="cameraTiltSliderDiv" class="cameraTiltSliderDiv" style="display: none;">
            <input type="range" id="cameraTiltSlider" class="cameraTiltSlider" min="-120" max="120" step="1">
        </div>
        <div id="timeSliderDiv" class="timeSliderDiv">
            <input type="range" id="timeSlider" class="timeSlider" min="0" max="10" step="0.00964"">
        </div>
    </div>

    <!-- お気に入り天体編集画面 -->
    <div id="userObject-manage" class="add-object" style="display: none;">
        <button id="userObject-close-manage" class="userObject-close-manage" type="button">&times;</button>
        <h3 class="add-object-title">お気に入り天体の編集</h3>
        <p class="userObject-note">好きな天体を追加できます。天体はデータを入力したデバイスにのみ表示され、ほかの利用者への影響やサーバーへの送信等はありません。</p>
        <div class="userObject-manage-wrapper">
            <div class="userObject-manage-type">星雲・星団</div>
            <div class="userObject-manage-table-wrapper">
                <table id="userObject-rec-items" class="userObject-manage-items"></table>
            </div>
        </div>
        <div class="add-object-typeSelect-button-div">
            <button id="userObject-rec-button" class="add-object-typeSelect-button" type="button">星雲・星団などを追加</button>
        </div>
        <div class="userObject-manage-wrapper">
            <div class="userObject-manage-type">太陽系天体</div>
            <div class="userObject-manage-table-wrapper">
                <table id="userObject-solarSystem-items" class="userObject-manage-items"></table>
            </div>
        </div>
        <div class="add-object-typeSelect-button-div">
            <button id="userObject-elliptic-button" class="add-object-typeSelect-button" type="button">太陽系天体（楕円軌道）を追加</button>
            <button id="userObject-parabolic-button" class="add-object-typeSelect-button" type="button">太陽系天体（放物線軌道）を追加</button>
            <button id="userObject-hyperbolic-button" class="add-object-typeSelect-button" type="button">太陽系天体（双曲線軌道）を追加</button>
        </div>
        <div id="userObject-finish-manage" class="userObject-finish-manage">完了</div>
    </div>

    <!-- 天体追加画面 星雲・星団 -->
    <div id="userObject-rec" class="add-object" style="display: none;">
        <button class="back-to-userObject-manage" type="button">&leftarrow;</button>
        <h3 class="add-object-title">星雲・星団を追加</h3>
        <h5 class="userObject-note">*がついているものは必須項目です。</h5>
        <ul class="userObject-elements">
            <li><label>名前*</label><input type="text" id="userObject-rec-name" class="short-text" placeholder="触角銀河"></li>
            <li><label>読み・別名（検索用。複数あるときはコンマ区切り。カタカナの読みは不要）</label><textarea id="userObject-rec-altname" class="long-text" placeholder="しょっかくぎんが,アンテナぎんが,NGC4038"></textarea></li>
            <li><label>種類</label>
                <select id="userObject-rec-type">
                    <option value="Gx">銀河</option>
                    <option value="OC">散開星団</option>
                    <option value="Gb">球状星団</option>
                    <option value="Nb">星雲・超新星残骸</option>
                    <option value="Pl">惑星状星雲</option>
                    <option value="C+N">星雲+星団</option>
                    <option value="Ast">星の集まり</option>
                    <option value="Kt">ほかの銀河内の星雲</option>
                    <option value="TS">三重星</option>
                    <option value="DS">二重星</option>
                    <option value="SS">単星</option>
                    <option value="?">その他</option>
                </select>
            </li>
            <li><label>赤経(J2000.0)*</label><input type="text" id="userObject-rec-ra" class="short-text" placeholder="12 01.9 or 180.475"></li>
            <li><label>赤緯(J2000.0)*</label><input type="text" id="userObject-rec-dec" class="short-text" placeholder="-18 52 or -18.867"></li>
            <li><label>等級</label><input type="text" id="userObject-rec-mag" class="short-text" placeholder="11"></li>
            <li><label>説明</label><textarea id="userObject-rec-description" class="long-text" placeholder="アンテナ銀河とも呼ばれる。触角は南北に0.4°ぐらい伸びてるけどけっこう暗そう"></textarea></li>
        </ul>
        <button id="userObject-rec-add-button" class="userObject-add-button" type="button">保存</button>
    </div>

    <!-- 天体追加画面 太陽系天体（楕円軌道） -->
    <div id="userObject-elliptic" class="add-object" style="display: none;">
        <button class="back-to-userObject-manage" type="button">&leftarrow;</button>
        <h3 class="add-object-title">楕円軌道の天体を追加</h3>
        <h5 class="userObject-note">*がついているものは必須項目です。</h5>
        <ul class="userObject-elements">
            <li><label>種類</label>
                <select id="userObject-elliptic-type">
                    <option value="asteroid">小惑星</option>
                    <option value="comet">彗星</option>
                </select>
            </li>
            <li><label>日本語名*</label><input type="text" id="userObject-elliptic-jpnName" class="short-text" placeholder="リュウグウ"></li>
            <li><label>ふりがな</label><input type="text" id="userObject-elliptic-hiraganaName" class="short-text" placeholder="りゅうぐう"></li>
            <li><label>英語名</label><input type="text" id="userObject-elliptic-engName" class="short-text" placeholder="Ryugu"></li>
            <li><label>元期の形式</label>
                <select id="userObject-elliptic-epochType">
                    <option value="ymd">年月日</option>
                    <option value="jd">ユリウス日</option>
                </select>
            </li>
            <li><label>元期(TT, 年月日)</label><input type="text" id="userObject-elliptic-ymd" class="short-text" placeholder="2025-05-05.0"></li>
            <li><label>元期(TT, ユリウス日)</label><input type="text" id="userObject-elliptic-jd" class="short-text" placeholder="2460800.5"></li>
            <li><label>軌道長半径 a [au]*</label><input type="text" id="userObject-elliptic-a" class="short-text" placeholder="1.19096"></li>
            <li><label>離心率 e*</label><input type="text" id="userObject-elliptic-e" class="short-text" placeholder="0.19105"></li>
            <li><label>軌道傾斜角 i [°]*</label><input type="text" id="userObject-elliptic-i" class="short-text" placeholder="5.8667"></li>
            <li><label>昇交点黄経 Ω, node [°]*</label><input type="text" id="userObject-elliptic-node" class="short-text" placeholder="251.2939"></li>
            <li><label>近日点引数 ω, peri [°]*</label><input type="text" id="userObject-elliptic-peri" class="short-text" placeholder="211.6098"></li>
            <li><label>元期の平均近点角 M0 [°]*</label><input type="text" id="userObject-elliptic-m0" class="short-text" placeholder="118.9955"></li>
            <li><label>絶対等級 H </label><input type="text" id="userObject-elliptic-h" class="short-text" placeholder="19.55"></li>
            <li><label>G</label><input type="text" id="userObject-elliptic-g" class="short-text" placeholder="0.15" value="0.15"></li>
        </ul>
        <button id="userObject-elliptic-add-button" class="userObject-add-button" type="button">保存</button>
    </div>

    <!-- 天体追加画面 太陽系天体（放物線軌道） -->
    <div id="userObject-parabolic" class="add-object" style="display: none;">
        <button class="back-to-userObject-manage" type="button">&leftarrow;</button>
        <h3 class="add-object-title">放物線軌道の天体を追加</h3>
        <h5 class="userObject-note">*がついているものは必須項目です。</h5>
        <ul class="userObject-elements">
            <li><label>日本語名*</label><input type="text" id="userObject-parabolic-jpnName" class="short-text" placeholder="ヘール・ボップ彗星"></li>
            <li><label>ふりがな</label><input type="text" id="userObject-parabolic-hiraganaName" class="short-text" placeholder="へーるぼっぷすいせい"></li>
            <li><label>英語名</label><input type="text" id="userObject-parabolic-engName" class="short-text" placeholder="Hale-Bopp"></li>
            <li><label>近日点通過日時の形式</label>
                <select id="userObject-parabolic-epochType">
                    <option value="ymd">年月日</option>
                    <option value="jd">ユリウス日</option>
                </select>
            </li>
            <li><label>近日点通過日時(TT, 年月日)</label><input type="text" id="userObject-parabolic-ymd" class="short-text" placeholder="1997-03-29.6"></li>
            <li><label>近日点通過日時(TT, ユリウス日)</label><input type="text" id="userObject-parabolic-jd" class="short-text" placeholder="2450537.1"></li>
            <li><label>近日点距離 q [au]*</label><input type="text" id="userObject-parabolic-q" class="short-text" placeholder="0.89054"></li>
            <li><label>軌道傾斜角 i [°]*</label><input type="text" id="userObject-parabolic-i" class="short-text" placeholder="89.2876"></li>
            <li><label>昇交点黄経 Ω, node [°]*</label><input type="text" id="userObject-parabolic-node" class="short-text" placeholder="282.7334"></li>
            <li><label>近日点引数 ω, peri [°]*</label><input type="text" id="userObject-parabolic-peri" class="short-text" placeholder="130.4147"></li>
        </ul>
        <button id="userObject-parabolic-add-button" class="userObject-add-button" type="button">保存</button>
    </div>

    <!-- 天体追加画面 太陽系天体（双曲線軌道） -->
    <div id="userObject-hyperbolic" class="add-object" style="display: none;">
        <button class="back-to-userObject-manage" type="button">&leftarrow;</button>
        <h3 class="add-object-title">双曲線軌道の天体を追加</h3>
        <h5 class="userObject-note">*がついているものは必須項目です。</h5>
        <ul class="userObject-elements">
            <li><label>名前*</label><input type="text" id="userObject-hyperbolic-jpnName" class="short-text" placeholder="'Oumuamua"></li>
            <li><label>読み・別名（検索用）</label><textarea id="userObject-hyperbolic-altname" class="long-text" placeholder="A/2017 U1"></textarea></li>
            <li><label>近日点通過日時の形式</label>
                <select id="userObject-hyperbolic-epochType">
                    <option value="ymd">年月日</option>
                    <option value="jd">ユリウス日</option>
                </select>
            </li>
            <li><label>近日点通過日時(TT, 年月日)</label><input type="text" id="userObject-hyperbolic-ymd" class="short-text" placeholder="2017-09-09.5"></li>
            <li><label>近日点通過日時(TT, ユリウス日)</label><input type="text" id="userObject-hyperbolic-jd" class="short-text" placeholder="2458006.0"></li>
            <li><label>近日点距離 q [au]*</label><input type="text" id="userObject-hyperbolic-q" class="short-text" placeholder="0.25591"></li>
            <li><label>軌道傾斜角 i [°]*</label><input type="text" id="userObject-hyperbolic-i" class="short-text" placeholder="122.7417"></li>
            <li><label>昇交点黄経 Ω, node [°]*</label><input type="text" id="userObject-hyperbolic-node" class="short-text" placeholder="24.5969"></li>
            <li><label>近日点引数 ω, peri [°]*</label><input type="text" id="userObject-hyperbolic-peri" class="short-text" placeholder="241.8105"></li>
        </ul>
        <button id="userObject-hyperbolic-add-button" class="userObject-add-button" type="button">保存</button>
    </div>

    <!-- エラー表示 -->
    <div id="errorMessage" class="error-message" style="display: none;">
        <div id="errorMessage-title" class="error-message-title">エラー</div>
        <div class="error-message-title">できればこの画面をスクショしてLINEとかで送ってください</div>
        <div class="error-message-title">多くのエラーはしばらく待ってから再読み込みすると解決するかも</div>
        <div id="errorMessage-text" class="error-message-text"></div>
        <div id="error-config" class="error-message-text"></div>
        <div id="error-userObject" class="error-message-text"></div>
    </div>

    <!-- AR用ビデオ -->
    <div>
        <video id="arVideo" class="ar-video" style="display: none;"></video>
    </div>

    <!-- キャンバス -->
    <div id="app">
        <canvas id="starChartCanvas"></canvas>
    </div>
    <script type="module">
        import { main } from './dist/main.js?v=251002-1111';
        window.addEventListener('DOMContentLoaded', main);
    </script>
    </body>
</html>